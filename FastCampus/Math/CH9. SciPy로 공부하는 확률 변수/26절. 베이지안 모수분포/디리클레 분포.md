# 디리클레 분포

디리클레 분포(Dirichlet distribution)는 베타 분포의 확장판이라고 할 수 있다. 베타 분포는 0과 1사이의 값을 가지는 단일(univariable) 확률 변수의 베이지안 모형에 사용되고, 디리클레 분포는 0과 1사이의 값을 가지는 다변수(multivariate) 확률 변수의 베이지안 모형에 사용된다. 다만 디리클레 분포를 다변수 확률 변수들의 합이 1이 되어야 한다는 제한조건을 가진다.

즉, $K=3$ 인 디리클레 분포를 따르는 확률 변수는 다음과 같은 값들을 샘플로 가질 수 있다.

$$(1,0,0)$$

$$(0.5, 0.5, 0)$$

$$(0.2,0.3,0.5)$$



즉, 디리클레 분포의 값은 다음과 같은 제한 조건을 따른다,

$$\sum_{i=1}^Kx_i = 1$$

디리클레 분포의 확률밀도함수는 다음과 같다.

$\text{Dir}(x_1, x_2, \cdots, x_K; \alpha_1, \alpha_2, \cdots, \alpha_K) = \frac{1}{\mathrm{B}(\alpha_1, \alpha_2, \cdots, \alpha_K)} \prod_{i=1}^K x_i^{\alpha_i - 1}$



위 식에서 $(\alpha_1, \alpha_2, \ldots, \alpha_K)$ 는 디리클레 분포의 모수 벡터이고 $\mathrm{B}(\alpha_1, \alpha_2, \cdots, \alpha_K)$ 는 베타 함수라는 특수 함수로 다음처럼 정의한다.

$\mathrm{B}(\alpha_1, \alpha_2, \cdots, \alpha_K) = \frac{\prod_{i=1}^K \Gamma(\alpha_i)} {\Gamma\bigl(\sum_{i=1}^K \alpha_i\bigr)}$



### 베타 분포와 디리클레 분포의 관계

베타 분포는 $K=2$ 인 디리클레 분포라고 볼 수 있다.

즉, $x_1=x, x_2=1-x, \alpha_1=a, \alpha_2=b$ 로 하면

$$\begin{eqnarray}\text{Beta}(x;a,b) &=& \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\, x^{a-1}(1-x)^{b-1} \\&=& \frac{\Gamma(\alpha_1+\alpha_2)}{\Gamma(\alpha_1)\Gamma(\alpha_2)}\,  x_1^{\alpha_1 - 1} x_2^{\alpha_2 - 1} \\&=& \frac{1}{\mathrm{B}(\alpha_1, \alpha_2)} \prod_{i=1}^2 x_i^{\alpha_i - 1}\end{eqnarray}$$



### 디리클레 분포의 모멘트

디리클레 분포의 기댓값, 분산, 최빈값(mode)은 다음과 같다. 수식에서 $\alpha$ 는 $\alpha=\sum\alpha_k$ 이다.

- 기댓값

$$\text{E}[x_k] = \dfrac{\alpha_k}{\alpha}$$

- 분산

$$\text{Var}[x_k] =\dfrac{\alpha_k(\alpha - \alpha_k)}{\alpha^2(\alpha + 1)}$$

- 최빈값(mode)

$$\dfrac{\alpha_k - 1}{\alpha - K}$$



기대값 공식을 보면 모수인 $(\alpha_1, \alpha_2, \ldots, \alpha_K)$ 는 $(x_1, x_2, \ldots, x_K)$ 중 어느 수가 더 크게 나올 가능성이 높은지를 결정하는 형상 인자(shape factor)임을 알 수 있다. 모든 $\alpha_i$ 값이 동일하면 모든 $x_i$ 의 분포가 같아진다.

또한 분산 공식을 보면 $(\alpha_1, \alpha_2, \ldots, \alpha_K)$ 의 절대값이 클수록 분산이 작아진다. 즉, 디리클리 분포의 표본값 $x$ 가 어떤 특정한 값 주변이 나올 가능성이 높아진다.



































